---
title: "TMEM"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{TMEM}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Package Install {.tabset .tabset-pills .tabset-fade}

### **Install TMEM Package from GitHub**

Install the package from `github`

```{r Github install package, include = F, warning = F, message = F, echo = T}
devtools::install_github('https://github.com/eriklarsen4/TMEM')
```

### **Install TMEM Package from CRAN**

Alternatively, if the package is accepted by CRAN, install from CRAN

```{r CRAN install TMEM package, include = F, warning = F, message = F, echo = T}
utils::install.packages('TMEM')
```

### **Attach TMEM Package

```{r Attach package, include = T, warning = F, message = F, echo = T}
library(TMEM)
devtools::load_all()
```

We'll use the datasets included in the `TMEM` package to demonstrate the functions in the package.

## Functions {.tabset .tabset-pills .tabset-fade}

### **GO_INFO_fn**

After installing and attaching the `TMEM` package, one crucial function of the package
is the `GO_INFO_fn` that gathers all the gene ontology information of a list of gene
or protein identifiers.

This is what is called `gene set enrichment analysis (GSEA)`.

The GSEA conducted on this dataset is included in full in [a markdown of another repository](https://github.com/eriklarsen4/Itch/blob/main/Code/GSEA/ItchGSEA.md),
along with additional analyses for [that paper](https://pmc.ncbi.nlm.nih.gov/articles/PMC8854445/#_ad93_).

```{r GO_INFO_fn call, include = T, warning = F, message = F, echo = T}
## First import the data in the package
data("aDRG_DEG_list")

## pass the variable into the function (data was derived from mouse)
results <- TMEM::GO_INFO_fn(list_of_interest = aDRG_DEG_list, species = 'mouse')
```

Inspect results by unpacking everything from the returned list

```{r GO_INFO_results, include = T, message = F, warning = F, echo = T}
  ## GO INFO about each Unique GO returned by the list
GO_INFO_by_TERM_df <- results |> 
  purrr::keep_at("GO_INFO_by_TERM_df") |> 
  as.data.frame() %>%
  dplyr::rename_with(., ~gsub(.x, pattern = 'GO_INFO_by_TERM_df\\.', replacement = ''))

  ## GO INFO about each gene in the list
GENE_GO_INFO_df <- results |> 
  purrr::keep_at("GENE_GO_INFO_df") |>
  as.data.frame() %>%
  dplyr::rename_with(., ~gsub(.x, pattern = 'GENE_GO_INFO_df\\.', replacement = ''))

  ## every alias for each gene in the list
aliases <- results |> 
  purrr::keep_at("aliases")

  ## all aliases from the list without the genes of the list
list_of_interest_aliases <- results |> 
  purrr::keep_at("list_of_interest_aliases") |>
  unlist() |> 
  as.character()

  ## Unique GOs returned by the list
Unique_GOs <- results |> 
  purrr::keep_at("Unique_GOs")

  ## Unique GO IDs returned by the list
Unique_GO_IDs <- results |> 
  purrr::keep_at("Unique_GO_IDs")
```

Print the `GO_INFO_by_TERM_df` to the console

```{r Show GO_INFO_df, include = T, message = F, warning = F, echo = T}
GO_INFO_by_TERM_df
```

### **ortholog_and_alias_fn**

Pass the gene list to the `ortholog_and_alias_fn`

Since the data is derived from `mouse`, `mouse` will serve as the `ref_species`

```{r Ortholog_and_alias_fn call, include = T, message = F, warning = F, echo = T}
ortholog_df <- TMEM::ortholog_and_alias_fn(ref_species = 'mouse', list_of_interest = aDRG_DEG_list)
```

Print the `ortholog_and_alias_fn` output to console

```{r Show ortholog results, include = T, message = F, warning = F, echo = T}
ortholog_df
```

Very useful to pass the list of genes with their aliases 
(c(`list_of_interest_aliases`, `aDRG_DEG_list`)) to the `GO_INFO_fn`

### **Query_GO_fn**

Another useful function with multiple uses is finding genes/proteins annotated 
to certain GO Terms.

This can be useful for:
+ investigating molecular pathways
+ investigating complexes for cross-checking or discovery
+ finding GO Terms that contain a regular expression string

```{r Query_GO_fn call, include = T, message = F, warning = F, echo = T}
TMEM::Query_GO_fn(model_org = 'human', GO_db = GO.db, string_terms = 'dense core vesicle') |> unlist()

c(AnnotationDbi::keys(GO.db, keytype = 'TERM')[
    which(
      grepl(AnnotationDbi::keys(GO.db, keytype = 'TERM'), pattern = 'dense core vesicle') == TRUE
    )
  ])

AnnotationDbi::keys(GO.db, keytype = 'TERM')
```

